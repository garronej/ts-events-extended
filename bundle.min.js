!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).evt=t()}}((function(){return function t(e,r,n){function o(a,u){if(!r[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};e[a][0].call(l.exports,(function(t){return o(e[a][1][t]||t)}),l,l.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.Ctx=void 0;var i=t("minimal-polyfills/Set"),a=t("minimal-polyfills/WeakMap"),u=t("tsafe/assert"),s=t("tsafe/is"),c=t("./LazyEvt"),l=t("./importProxy"),f=t("tsafe/lab/overwriteReadonlyProp"),p=function(){function t(){this.lazyEvtAttach=new c.LazyEvt,this.lazyEvtDetach=new c.LazyEvt,this.lazyEvtDoneOrAborted=new c.LazyEvt,this.handlers=new i.Polyfill,this.evtByHandler=new a.Polyfill}return Object.defineProperty(t.prototype,"evtDoneOrAborted",{get:function(){return this.lazyEvtDoneOrAborted.evt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"evtAttach",{get:function(){return this.lazyEvtAttach.evt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"evtDetach",{get:function(){return this.lazyEvtDetach.evt},enumerable:!1,configurable:!0}),t.prototype.onDoneOrAborted=function(t){this.lazyEvtDoneOrAborted.post(t)},t.prototype.waitFor=function(t){var e=this;return this.evtDoneOrAborted.waitFor(t).then((function(t){if("ABORTED"===t.type)throw t.error;return t.result}),(function(t){throw e.abort(t),t}))},t.prototype.abort=function(t){return this.__done(t)},t.prototype.done=function(t){return this.__done(void 0,t)},t.prototype.__done=function(t,e){var r,i,a=[];try{for(var u=o(this.handlers.values()),s=u.next();!s.done;s=u.next()){var c=s.value,l=this.evtByHandler.get(c);c.detach()&&a.push({handler:c,evt:l})}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return this.onDoneOrAborted(n(n({},t?{type:"ABORTED",error:t}:{type:"DONE",result:e}),{handlers:a})),a},t.prototype.getHandlers=function(){var t=this;return Array.from(this.handlers.values()).map((function(e){return{handler:e,evt:t.evtByHandler.get(e)}}))},t.prototype.zz__addHandler=function(t,e){u.assert(t.ctx===this),u.assert(s.is(t)),this.handlers.add(t),this.evtByHandler.set(t,e),this.lazyEvtAttach.post({handler:t,evt:e})},t.prototype.zz__removeHandler=function(t){u.assert(t.ctx===this),u.assert(s.is(t)),this.lazyEvtDetach.post({handler:t,evt:this.evtByHandler.get(t)}),this.handlers.delete(t)},t}();r.Ctx=p;try{f.overwriteReadonlyProp(r.Ctx,"name","Ctx")}catch(t){}l.importProxy.Ctx=r.Ctx},{"./LazyEvt":14,"./importProxy":17,"minimal-polyfills/Set":40,"minimal-polyfills/WeakMap":41,"tsafe/assert":43,"tsafe/is":45,"tsafe/lab/overwriteReadonlyProp":47}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.asNonPostable=void 0,r.asNonPostable=function(t){return t}},{}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.asPostable=void 0,r.asPostable=function(t){return t}},{}],4:[function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.asyncPipe=void 0;var i=t("./importProxy");r.asyncPipe=function(t,e){var r=this,a="state"in t?i.importProxy.Evt.create(void 0):i.importProxy.Evt.create(),u=0;return t.attach((function(i){return n(r,void 0,void 0,(function(){var r,n,s;return o(this,(function(o){switch(o.label){case 0:return u++,r=u,null!==(n=e(i))&&"then"in n?[4,n]:[3,2];case 1:return s=o.sent(),"state"in t&&r!==u?[2]:[3,3];case 2:s=n,o.label=3;case 3:return s?(a.post(s[0]),[2]):[2]}}))}))})),a}},{"./importProxy":17}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=void 0;var n=t("./importProxy");r.create=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?new n.importProxy.Evt:new n.importProxy.StatefulEvt(t[0])}},{"./importProxy":17}],6:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.factorize=void 0,r.factorize=function(t){return t}},{}],7:[function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.from=void 0;var o=t("tsafe/id"),i=t("tsafe/assert"),a=t("tsafe/typeGuard"),u=t("./Evt.merge"),s=t("./importProxy"),c=t("./types/EventTargetLike").EventTargetLike;function l(t,e,r,n){var a,f,p,d;if(p=e,!c.canBe(p)){if("then"in e){var h=new s.importProxy.Evt,v=(f=(a=function(){return null==t?void 0:t.evtDoneOrAborted.postCount})(),function(){return f!==a()});return e.then((function(t){v()||h.post(t)})),h}return u.mergeImpl(t,Array.from(e).map((function(e){return l(t,e,r,n)})))}if(c.NodeStyleEventEmitter.match(e))d={on:function(t,r){return e.addListener(r,t)},off:function(t,r){return e.removeListener(r,t)}};else if(c.JQueryStyleEventEmitter.match(e))d={on:function(t,r){return e.on(r,t)},off:function(t,r){return e.off(r,t)}};else if(c.HasEventTargetAddRemove.match(e))d={on:function(t,r,n){return e.addEventListener(r,t,n)},off:function(t,r,n){return e.removeEventListener(r,t,n)}};else if(c.RxJSSubject.match(e)){var y;d={on:function(t){return y=e.subscribe((function(e){return t(e)}))},off:function(){return y.unsubscribe()}}}else o.id(e),i.assert(!1);var b=new s.importProxy.Evt,m=function(t){return b.post(t)};return null==t||t.evtDoneOrAborted.attachOnce((function(){return d.off(m,r,n)})),d.on(m,r,n),b}function f(t,e,r){var o=s.importProxy.Evt.create(),i=new e((function(t){var e=n(t,1)[0];return o.post(e)}));return i.observe(r),null==t||t.evtDoneOrAborted.attachOnce((function(){return i.disconnect()})),o}r.from=function(t,e,r,n){return"evtDoneOrAborted"in t?(i.assert(a.typeGuard(e,!0)&&a.typeGuard(r,!0)&&a.typeGuard(n,!0)),"function"==typeof e?(i.assert(a.typeGuard(r,!0)&&a.typeGuard(n,!0)),f(t,e,r)):(i.assert(a.typeGuard(r,!0)),l(t,e,r,n))):(i.assert(a.typeGuard(t,!0)&&a.typeGuard(e,!0)&&a.typeGuard(r,!0)),"function"==typeof t?(i.assert(a.typeGuard(e,!0)&&a.typeGuard(r,!0)),f(void 0,t,e)):(i.assert(a.typeGuard(e,!0)),l(void 0,t,e,r)))}},{"./Evt.merge":11,"./importProxy":17,"./types/EventTargetLike":19,"tsafe/assert":43,"tsafe/id":44,"tsafe/typeGuard":48}],8:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getCtxFactory=void 0;var n=t("minimal-polyfills/WeakMap"),o=t("./importProxy");r.getCtxFactory=function(){var t=new n.Polyfill;return function(e){var r=t.get(e);return void 0===r&&(r=new o.importProxy.Ctx,t.set(e,r)),r}}},{"./importProxy":17,"minimal-polyfills/WeakMap":41}],9:[function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.Evt=r.onAddHandlerByEvt=void 0,t("minimal-polyfills/Array.prototype.find");var u=t("./importProxy"),s=t("./Evt.create"),c=t("./Evt.getCtx"),l=t("./Evt.factorize"),f=t("./Evt.merge"),p=t("./Evt.from"),d=t("./Evt.asPostable"),h=t("./Evt.asyncPipe"),v=t("./Evt.asNonPostable"),y=t("./Evt.parsePropsFromArgs"),b=t("./Evt.newCtx"),m=t("./LazyEvt"),_=t("minimal-polyfills/Map"),g=t("minimal-polyfills/WeakMap"),P=t("run-exclusive"),O=t("tsafe/lab/overwriteReadonlyProp"),E=t("tsafe/typeGuard"),x=t("../tools/Deferred"),w=t("./Evt.loosenType"),j=t("../tools/safeSetTimeout"),C=t("tsafe/isPromiseLike"),M=t("./types/EvtError"),S=t("./types/interfaces/CtxLike"),A=t("./util/convertOperatorToStatelessFLambda"),k=function(t){return t()},T=S.CtxLike,z=function(){function t(){this.lazyEvtAttach=new m.LazyEvt,this.lazyEvtDetach=new m.LazyEvt,this.__maxHandlers=void 0,this.postCount=0,this.traceId=null,this.handlers=[],this.handlerTriggers=new _.Polyfill,this.__currentChronologyMark=0,this.asyncHandlerCount=0}return t.setDefaultMaxHandlers=function(t){this.__defaultMaxHandlers=isFinite(t)?t:0},t.prototype.toStateful=function(t,e){var r=T.match(t),n=r?void 0:t,o=e||(r?t:void 0),i=new u.importProxy.StatefulEvt(n),a=function(t){return i.post(t)};return o?this.attach(o,a):this.attach(a),i},Object.defineProperty(t.prototype,"evtAttach",{get:function(){return this.lazyEvtAttach.evt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"evtDetach",{get:function(){return this.lazyEvtDetach.evt},enumerable:!1,configurable:!0}),t.prototype.setMaxHandlers=function(t){return this.__maxHandlers=isFinite(t)?t:0,this},t.prototype.enableTrace=function(t){var e=t.id,r=t.formatter,n=t.log;this.traceId=e,this.traceFormatter=r||function(t){try{return JSON.stringify(t,null,2)}catch(e){return""+t}},this.log=void 0===n?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return console.log.apply(console,i([],o(t)))}:!1===n?void 0:n},t.prototype.disableTrace=function(){return this.traceId=null,this},Object.defineProperty(t.prototype,"asyncHandlerChronologyMark",{get:function(){var t,e,r;return null!==(e=(r=null!==(t=this["~internal"])&&void 0!==t?t:this["~internal"]={}).asyncHandlerChronologyMark)&&void 0!==e?e:r.asyncHandlerChronologyMark=new g.Polyfill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"asyncHandlerChronologyExceptionRange",{get:function(){var t,e,r;return null!==(e=(r=null!==(t=this["~internal"])&&void 0!==t?t:this["~internal"]={}).asyncHandlerChronologyExceptionRange)&&void 0!==e?e:r.asyncHandlerChronologyExceptionRange=new g.Polyfill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"invocableOpByOp",{get:function(){var t,e,r;return null!==(e=(r=null!==(t=this["~internal"])&&void 0!==t?t:this["~internal"]={}).invocableOpByOp)&&void 0!==e?e:r.invocableOpByOp=new g.Polyfill},enumerable:!1,configurable:!0}),t.prototype.getInvocableOp=function(t){var e=this.invocableOpByOp.get(t);if(void 0===e)throw new Error(["Provided operator isn't the operator of any handler","currently attached to the Evt instance"].join(" "));return e},t.prototype.getChronologyMark=function(){return this.__currentChronologyMark++},t.prototype.detachHandler=function(t,e,r){var n=this.handlers.indexOf(t);return!(n<0)&&(E.typeGuard(t,!!t.ctx)&&t.ctx.zz__removeHandler(t),this.handlers.splice(n,1),t.async&&this.asyncHandlerCount--,this.handlerTriggers.delete(t),void 0!==e[0]&&(j.safeClearTimeout(e[0]),r(new M.DetachedEvtError)),this.lazyEvtDetach.post(t),!0)},t.prototype.triggerHandler=function(t,e,r,n){var i=t.callback,a=t.once;void 0!==e[0]&&(j.safeClearTimeout(e[0]),e[0]=void 0),a&&t.detach();var u=o(n,1)[0],s=null==i?void 0:i.call(this,u);return null==r||r(u),C.isPromiseLike(s)?s:void 0},t.prototype.addHandler=function(t,e){var o,i=this;this.invocableOpByOp.set(t.op,A.convertOperatorToStatelessFλ(t.op));var a=new x.Deferred,u=[void 0],s=n(n(n({},t),e),{detach:function(){return i.detachHandler(s,u,a.reject)},promise:a.pr});"number"==typeof s.timeout&&(u[0]=j.safeSetTimeout((function(){u[0]=void 0,s.detach(),a.reject(new M.TimeoutEvtError(s.timeout))}),s.timeout));var c=function(t){return i.triggerHandler(s,u,a.isPending?a.resolve:void 0,t)};if(this.handlerTriggers.set(s,c),s.async&&this.asyncHandlerChronologyMark.set(s,this.getChronologyMark()),s.prepend){var l=void 0;for(l=0;l<this.handlers.length&&this.handlers[l].extract;l++);this.handlers.splice(l,0,s)}else this.handlers.push(s);return s.async&&this.asyncHandlerCount++,this.checkForPotentialMemoryLeak(),E.typeGuard(s,!!s.ctx)&&s.ctx.zz__addHandler(s,this),null===(o=r.onAddHandlerByEvt.get(this))||void 0===o||o(s,c),this.handlerTriggers.has(s)&&this.lazyEvtAttach.post(s),s},t.prototype.checkForPotentialMemoryLeak=function(){var e=void 0!==this.__maxHandlers?this.__maxHandlers:t.__defaultMaxHandlers;if(0!==e&&this.handlers.length%(e+1)==0){var r=["MaxHandlersExceededWarning: Possible Evt memory leak detected.",this.handlers.length+" handlers attached"+(this.traceId?' to "'+this.traceId+'"':"")+".\n","Use Evt.prototype.setMaxHandlers(n) to increase limit on a specific Evt.\n","Use Evt.setDefaultMaxHandlers(n) to change the default limit currently set to "+t.__defaultMaxHandlers+".\n"].join(""),o=new _.Polyfill;this.getHandlers().map((function(t){var e=t.ctx,r=t.async,o=t.once,i=t.prepend,a=t.extract,u=t.op,s=t.callback;return n(n({hasCtx:!!e,once:o,prepend:i,extract:a,isWaitFor:r},u===y.matchAll?{}:{op:u.toString()}),s?{callback:s.toString()}:{})})).map((function(t){return"{\n"+Object.keys(t).map((function(e){return"  "+e+": "+t[e]})).join(",\n")+"\n}"})).forEach((function(t){return o.set(t,(o.has(t)?o.get(t):0)+1)})),r+="\n"+Array.from(o.keys()).map((function(t){return o.get(t)+" handler"+(1===o.get(t)?"":"s")+" like:\n"+t})).join("\n")+"\n",null===this.traceId&&(r+="\n"+["To validate the identify of the Evt instance that is triggering this warning you can call",'Evt.prototype.enableTrace({ "id": "My evt id", "log": false }) on the Evt that you suspect.\n'].join(" "));try{console.warn(r)}catch(t){}}},t.prototype.isHandledByOp=function(t,e){var r,n=!1;try{r=this.getInvocableOp(t)}catch(t){return!1}return null!==r(e,(function(){return n=!0}))||n},t.prototype.trace=function(t){var e,r=this;if(null!==this.traceId){var n="("+this.traceId+") ";if(!!this.handlers.find((function(e){var n=e.extract,o=e.op;return n&&r.isHandledByOp(o,t)})))n+="extracted ";else{var o=this.handlers.filter((function(e){var n=e.extract,o=e.op;return!n&&r.isHandledByOp(o,t)})).length;n+=o+" handler"+(o>1?"s":"")+", "}null===(e=this.log)||void 0===e||e.call(this,n+this.traceFormatter(t))}},t.prototype.postSync=function(t){var e,r,n=[],u=function(t){return[t,Promise.all(n).then((function(){}))]};try{for(var s=a(i([],o(this.handlers))),c=s.next();!c.done;c=s.next()){var l=c.value,f=l.async,p=l.op,d=l.extract;if(!f){var h=this.handlerTriggers.get(l),v=this.getInvocableOp(p)(t,k);if(null!==v&&h){var y=h(v);if(void 0!==y&&n.push(y),d)return u(!0)}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return u(!1)},t.prototype.postAsyncFactory=function(){var t=this;return P.buildMethodCb((function(e,r,n){var u,s;if(0!==t.asyncHandlerCount){var c,l=[];Promise.resolve().then((function(){return c=t.getChronologyMark()}));var f=function(n){if(!n.async)return"continue";var o=t.getInvocableOp(n.op)(e,k);if(null===o)return"continue";var i=t.handlerTriggers.get(n);return i&&function(){var e=t.asyncHandlerChronologyMark.get(n);if(r>e)return!0;var o=t.asyncHandlerChronologyExceptionRange.get(n);return void 0!==o&&o.lowerMark<r&&r<o.upperMark&&e>o.upperMark}()?(l.push(new Promise((function(t){return n.promise.then((function(){return t()})).catch((function(){return t()}))}))),void i(o)):"continue"};try{for(var p=a(i([],o(t.handlers))),d=p.next();!d.done;d=p.next()){f(d.value)}}catch(t){u={error:t}}finally{try{d&&!d.done&&(s=p.return)&&s.call(p)}finally{if(u)throw u.error}}if(0!==l.length){var h=i([],o(t.handlers));Promise.all(l).then((function(){var e,o;try{for(var i=a(t.handlers),u=i.next();!u.done;u=i.next()){var s=u.value;s.async&&(h.indexOf(s)>=0||t.asyncHandlerChronologyExceptionRange.set(s,{lowerMark:r,upperMark:c}))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(o=i.return)&&o.call(i)}finally{if(e)throw e.error}}n()}))}else n()}else n()}))},t.prototype.isHandled=function(t){var e=this;return!!this.getHandlers().find((function(r){var n=r.op;return e.isHandledByOp(n,t)}))},t.prototype.getHandlers=function(){return i([],o(this.handlers))},t.prototype.detach=function(t){var e,r,n=[];try{for(var o=a(this.getHandlers()),i=o.next();!i.done;i=o.next()){var u=i.value;if(void 0===t||u.ctx===t)u.detach()&&n.push(u)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype.pipe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=new t;return this.addHandler(n(n({},y.parsePropsFromArgs(e,"pipe")),{callback:function(t){return o.post(t)}}),t.propsFormMethodNames.attach),o},t.prototype.waitFor=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this.addHandler(y.parsePropsFromArgs(e,"waitFor"),t.propsFormMethodNames.waitFor).promise},t.prototype.$attach=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.attach.apply(this,i([],o(t)))},t.prototype.attach=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.__attachX(t,"attach")},t.prototype.$attachOnce=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.attachOnce.apply(this,i([],o(t)))},t.prototype.attachOnce=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.__attachX(t,"attachOnce")},t.prototype.$attachExtract=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.attachExtract.apply(this,i([],o(t)))},t.prototype.attachExtract=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.__attachX(t,"attachExtract")},t.prototype.$attachPrepend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.attachPrepend.apply(this,i([],o(t)))},t.prototype.attachPrepend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.__attachX(t,"attachPrepend")},t.prototype.$attachOncePrepend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.attachOncePrepend.apply(this,i([],o(t)))},t.prototype.attachOncePrepend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.__attachX(t,"attachOncePrepend")},t.prototype.$attachOnceExtract=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.attachOnceExtract.apply(this,i([],o(t)))},t.prototype.attachOnceExtract=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.__attachX(t,"attachOnceExtract")},t.prototype.__attachX=function(e,r){var n=y.parsePropsFromArgs(e,"attach*"),o=this.addHandler(n,t.propsFormMethodNames[r]);return void 0===n.timeout?this:o.promise},t.prototype.postAsyncOnceHandled=function(t){var e=this;if(this.isHandled(t))return this.post(t);var r=new x.Deferred;return this.evtAttach.attachOnce((function(r){var n=r.op;return e.isHandledByOp(n,t)}),(function(){return Promise.resolve().then((function(){return r.resolve(e.post(t))}))})),r.pr},t.prototype.postOrPostAndWait=function(t,e){var r=this;this.trace(t),O.overwriteReadonlyProp(this,"postCount",this.postCount+1);var n=this.getChronologyMark(),i=o(this.postSync(t),2),a=i[0],u=i[1],s=e?function(){return u}:function(){return r.postCount};if(a)return s();if(void 0===this.postAsync){if(0===this.asyncHandlerCount)return s();this.postAsync=this.postAsyncFactory()}return this.postAsync(t,n),s()},t.prototype.post=function(t){return this.postOrPostAndWait(t,!1)},t.prototype.postAndWait=function(t){return this.postOrPostAndWait(t,!0)},t.create=s.create,t.newCtx=b.newCtx,t.merge=f.merge,t.from=p.from,t.getCtx=c.getCtxFactory(),t.loosenType=w.loosenType,t.factorize=l.factorize,t.asPostable=d.asPostable,t.asyncPipe=h.asyncPipe,t.asNonPostable=v.asNonPostable,t.__defaultMaxHandlers=25,t.propsFormMethodNames={waitFor:{async:!0,extract:!1,once:!0,prepend:!1},attach:{async:!1,extract:!1,once:!1,prepend:!1},attachExtract:{async:!1,extract:!0,once:!1,prepend:!0},attachPrepend:{async:!1,extract:!1,once:!1,prepend:!0},attachOnce:{async:!1,extract:!1,once:!0,prepend:!1},attachOncePrepend:{async:!1,extract:!1,once:!0,prepend:!0},attachOnceExtract:{async:!1,extract:!0,once:!0,prepend:!0}},t}();r.onAddHandlerByEvt=new g.Polyfill,r.Evt=z;try{O.overwriteReadonlyProp(r.Evt,"name","Evt")}catch(t){}u.importProxy.Evt=r.Evt},{"../tools/Deferred":35,"../tools/safeSetTimeout":36,"./Evt.asNonPostable":2,"./Evt.asPostable":3,"./Evt.asyncPipe":4,"./Evt.create":5,"./Evt.factorize":6,"./Evt.from":7,"./Evt.getCtx":8,"./Evt.loosenType":10,"./Evt.merge":11,"./Evt.newCtx":12,"./Evt.parsePropsFromArgs":13,"./LazyEvt":14,"./importProxy":17,"./types/EvtError":20,"./types/interfaces/CtxLike":24,"./util/convertOperatorToStatelessFLambda":28,"minimal-polyfills/Array.prototype.find":37,"minimal-polyfills/Map":38,"minimal-polyfills/WeakMap":41,"run-exclusive":42,"tsafe/isPromiseLike":46,"tsafe/lab/overwriteReadonlyProp":47,"tsafe/typeGuard":48}],10:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.loosenType=void 0,r.loosenType=function(t){return t}},{}],11:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.merge=r.mergeImpl=void 0;var n=t("./importProxy");function o(t,e){var r=new n.importProxy.Evt,o=function(t){return r.post(t)};return e.forEach((function(e){void 0===t?e.attach(o):e.attach(t,o)})),r}r.mergeImpl=o,r.merge=function(t,e){return"length"in t?o(void 0,t):o(t,e)}},{"./importProxy":17}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.newCtx=void 0;var n=t("./importProxy");r.newCtx=function(){return new n.importProxy.Ctx}},{"./importProxy":17}],13:[function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t};Object.defineProperty(r,"__esModule",{value:!0}),r.parsePropsFromArgs=r.matchAll=void 0;var a=t("tsafe/id"),u=t("./util/compose"),s=t("tsafe/typeGuard");function c(){return!0}r.matchAll=c;var l=function(t){return void 0!==t&&s.typeGuard(t,!0)&&("function"==typeof t||"function"==typeof t[0])},f={op:c,ctx:void 0,timeout:void 0,callback:void 0};r.parsePropsFromArgs=function t(e,r){switch(r){case"pipe":var s=function(t){return 0===t.length?{}:{op:1===t.length?t[0]:u.compose.apply(void 0,i([],o(t)))}};if(l(e[0]))return a.id(n(n({},f),s(e)));var c=o(e),p=c[0],d=c.slice(1);return a.id(n(n(n({},f),void 0!==p?{ctx:p}:{}),s(d)));case"waitFor":return t(i(i([],o(e.filter((function(t,r){return!(r===e.length-1&&void 0===t)})))),[f.callback]),"attach*");case"attach*":switch(e.length){case 4:var h=o(e,4),v=h[0],y=h[1],b=h[2],m=h[3];return a.id(n(n({},f),{op:v,ctx:y,timeout:b,callback:m}));case 3:var _=o(e,3);v=_[0],y=_[1],b=_[2];if("number"==typeof y){var g=y,P=b;return l(v)?a.id(n(n({},f),{timeout:g,callback:P,op:v})):a.id(n(n({},f),{timeout:g,callback:P,ctx:v}))}return a.id(n(n({},f),{op:v,ctx:y,callback:b}));case 2:var O=o(e,2);v=O[0],y=O[1];if("number"==typeof v)return a.id(n(n({},f),{timeout:v,callback:y}));P=y;return l(v)?a.id(n(n({},f),{callback:P,op:v})):a.id(n(n({},f),{callback:P,ctx:v}));case 1:var E=o(e,1)[0];return a.id(n(n({},f),{callback:E}));case 0:return a.id(n({},f))}}}},{"./util/compose":27,"tsafe/id":44,"tsafe/typeGuard":48}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LazyEvt=void 0;var n=t("tsafe/lab/overwriteReadonlyProp"),o=t("./importProxy"),i=function(){function t(){this.initialPostCount=0}return Object.defineProperty(t.prototype,"evt",{get:function(){return void 0===this.__evt&&(this.__evt=new o.importProxy.Evt,n.overwriteReadonlyProp(this.__evt,"postCount",this.initialPostCount)),this.__evt},enumerable:!1,configurable:!0}),t.prototype.__post=function(t,e){return void 0===this.__evt?++this.initialPostCount:this.__evt[e?"postAndWait":"post"](t)},t.prototype.post=function(t){return this.__post(t,!1)},t.prototype.postAndWait=function(t){return this.__post(t,!0)},t}();r.LazyEvt=i},{"./importProxy":17,"tsafe/lab/overwriteReadonlyProp":47}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LazyStatefulEvt=void 0;var n=t("tsafe/lab/overwriteReadonlyProp"),o=t("./importProxy"),i=function(){function t(t){this.initialPostCount=0,this.initialState=t}return Object.defineProperty(t.prototype,"evt",{get:function(){return void 0===this.__evt&&(this.__evt=new o.importProxy.StatefulEvt(this.initialState),this.initialState=null,n.overwriteReadonlyProp(this.__evt,"postCount",this.initialPostCount)),this.__evt},enumerable:!1,configurable:!0}),t.prototype.__post=function(t,e){return void 0===this.__evt?(this.initialState=t,++this.initialPostCount):this.__evt[e?"postAndWait":"post"](t)},t.prototype.post=function(t){return this.__post(t,!1)},t.prototype.postAndWait=function(t){return this.__post(t,!0)},t}();r.LazyStatefulEvt=i},{"./importProxy":17,"tsafe/lab/overwriteReadonlyProp":47}],16:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t};Object.defineProperty(r,"__esModule",{value:!0}),r.StatefulEvt=void 0,t("minimal-polyfills/Object.is");var u=t("./LazyEvt"),s=t("./LazyStatefulEvt"),c=t("./importProxy"),l=t("./Evt.parsePropsFromArgs"),f=t("./Evt"),p=function(t){return t()},d=function(t){function e(e){var r=t.call(this)||this;return r.lazyEvtDiff=new u.LazyEvt,r.lazyEvtChangeDiff=new u.LazyEvt,r.__state=e,r.lazyEvtChange=new s.LazyStatefulEvt(r.__state),f.onAddHandlerByEvt.set(r,(function(t,e){var n=r.getInvocableOp(t.op)(r.__state,p);n&&e(n)})),r}return o(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this.__state},set:function(t){this.state!==t&&this.post(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"evtDiff",{get:function(){return this.lazyEvtDiff.evt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"evtChange",{get:function(){return this.lazyEvtChange.evt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"evtChangeDiff",{get:function(){return this.lazyEvtChangeDiff.evt},enumerable:!1,configurable:!0}),e.prototype.post=function(t){return this.__post(t,!1,!1)},e.prototype.postForceChange=function(t){return this.__post(t?t[0]:this.state,!0,!1)},e.prototype.postAndWait=function(t){return this.__post(t,!1,!0)},e.prototype.__post=function(e,r,n){var o=this.state;this.__state=e;var i={prevState:o,newState:this.state},a=n?"postAndWait":"post",u=[],s=this.lazyEvtDiff[a](i);if(n&&u.push(s),r||!Object.is(o,this.state)){var c=this.lazyEvtChange[a](this.state),l=this.lazyEvtChangeDiff[a](i);n&&u.push(c,l)}var f=t.prototype[a].call(this,e);return n?(u.push(f),Promise.all(u).then((function(){}))):f},e.prototype.pipe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=t.prototype.pipe.apply(this,a([],i(e))),o=this.getInvocableOp(l.parsePropsFromArgs(e,"pipe").op)(this.__state,p);if(!o)throw new Error(["Cannot pipe StatefulEvt because the operator does not match","it's current state. You would end up with evt.state === undefined","Use evt.toStateless([ctx]).pipe(op).toStatic(initialState)","to be sure the StatefulEvt does not have an undefined state"].join(" "));return n.toStateful(o[0])},e.prototype.toStateless=function(e){return e?t.prototype.pipe.call(this,e):t.prototype.pipe.call(this)},e}(f.Evt);r.StatefulEvt=d,c.importProxy.StatefulEvt=r.StatefulEvt},{"./Evt":9,"./Evt.parsePropsFromArgs":13,"./LazyEvt":14,"./LazyStatefulEvt":15,"./importProxy":17,"minimal-polyfills/Object.is":39}],17:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.importProxy=void 0,r.importProxy={}},{}],18:[function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.StatefulEvt=r.Evt=r.Ctx=void 0,o(t("./types"),r),o(t("./util"),r);var i=t("./Ctx");Object.defineProperty(r,"Ctx",{enumerable:!0,get:function(){return i.Ctx}});var a=t("./Evt");Object.defineProperty(r,"Evt",{enumerable:!0,get:function(){return a.Evt}});var u=t("./StatefulEvt");Object.defineProperty(r,"StatefulEvt",{enumerable:!0,get:function(){return u.StatefulEvt}})},{"./Ctx":1,"./Evt":9,"./StatefulEvt":16,"./types":23,"./util":34}],19:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EventTargetLike=void 0;var n=t("tsafe/typeGuard");!function(t){var e,r,o,i;!function(t){t.match=function(t){return n.typeGuard(t,!0)&&t instanceof Object&&"function"==typeof t.subscribe}}(e=t.RxJSSubject||(t.RxJSSubject={})),function(t){t.match=function(t){return n.typeGuard(t,!0)&&t instanceof Object&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}}(r=t.NodeStyleEventEmitter||(t.NodeStyleEventEmitter={})),function(t){t.match=function(t){return n.typeGuard(t,!0)&&t instanceof Object&&"function"==typeof t.on&&"function"==typeof t.off}}(o=t.JQueryStyleEventEmitter||(t.JQueryStyleEventEmitter={})),function(t){t.match=function(t){return n.typeGuard(t,!0)&&t instanceof Object&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}}(i=t.HasEventTargetAddRemove||(t.HasEventTargetAddRemove={})),t.canBe=function(t){try{return i.match(t)||r.match(t)||o.match(t)||e.match(t)}catch(t){return!1}}}(r.EventTargetLike||(r.EventTargetLike={}))},{"tsafe/typeGuard":48}],20:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.DetachedEvtError=r.TimeoutEvtError=void 0;var i=function(t){function e(e){var r=this.constructor,n=t.call(this,"Evt timeout after "+e+"ms")||this;return n.timeout=e,Object.setPrototypeOf(n,r.prototype),n}return o(e,t),e}(Error);r.TimeoutEvtError=i;var a=function(t){function e(){var e=this.constructor,r=t.call(this,"Evt handler detached")||this;return Object.setPrototypeOf(r,e.prototype),r}return o(e,t),e}(Error);r.DetachedEvtError=a},{}],21:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],22:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],23:[function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.dom=void 0,o(t("./helper"),r),o(t("./interfaces"),r),r.dom=t("./lib.dom"),o(t("./EventTargetLike"),r),o(t("./EvtError"),r),o(t("./Operator"),r)},{"./EventTargetLike":19,"./EvtError":20,"./Operator":21,"./helper":22,"./interfaces":25,"./lib.dom":26}],24:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CtxLike=void 0;var n=t("tsafe/typeGuard");!function(t){t.match=function(t){return n.typeGuard(t,!0)&&t instanceof Object&&"function"==typeof t.done&&"function"==typeof t.abort&&"function"==typeof t.zz__addHandler&&"function"==typeof t.zz__removeHandler}}(r.CtxLike||(r.CtxLike={}))},{"tsafe/typeGuard":48}],25:[function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),o(t("./CtxLike"),r)},{"./CtxLike":24}],26:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.__hack=void 0,
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0
 
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.
 
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
r.__hack="NOT TYPE ONLY"},{}],27:[function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t};Object.defineProperty(r,"__esModule",{value:!0}),r.compose=void 0;var i=t("./convertOperatorToStatelessFLambda"),a=t("tsafe/id");function u(t,e){var r=i.convertOperatorToStatelessFλ(t),o=i.convertOperatorToStatelessFλ(e);return a.id((function(t,e){var i=r(t,e);if(!i)return null;var a=n(i,1)[0],u=o(a,e);return u?[u[0]]:u}))}r.compose=function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(1===e.length){var a=n(e,1),s=a[0];return i.convertOperatorToStatelessFλ(s)}var c=n(e),l=c[0],f=c[1],p=c.slice(2),d=u(l,f);return 0===p.length?d:t.apply(void 0,o([d],n(p)))}},{"./convertOperatorToStatelessFLambda":28,"tsafe/id":44}],28:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.convertOperatorToStatelessFλ=void 0,r.convertOperatorToStatelessFλ=function(t){return"function"!=typeof t?(r=(e=t)[1],function(t,n){var o=e[0](t,r,n);return null!==o&&n((function(){return r=o[0]})),o}):function(t){return function(e,r){var n=t(e,r);return n instanceof Object&&!("input"in n)&&1===n.length?n:n?[e]:null}}(t);var e,r}},{}],29:[function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t};Object.defineProperty(r,"__esModule",{value:!0}),r.distinct=void 0;var i=t("../compose");r.distinct=function(t,e){var r;return i.compose((function(r){var n,o;return[{data:r,selectedKey:null!==(n=null==t?void 0:t(r))&&void 0!==n?n:r,currentFlushCount:null!==(o=null==e?void 0:e.evtDoneOrAborted.postCount)&&void 0!==o?o:0}]}),[function(t,e){var r=t.data,i=t.selectedKey,a=t.currentFlushCount,u=e.alreadyPostedData,s=e.previousFlushCount;return[{boxedData:a===s&&u.has(i)?null:[r],alreadyPostedData:new Set(o(o([],n(a!==s?[]:Array.from(u))),[i])),previousFlushCount:a}]},{boxedData:null,alreadyPostedData:new Set,previousFlushCount:null!==(r=null==e?void 0:e.evtDoneOrAborted.postCount)&&void 0!==r?r:0}],(function(t){return t.boxedData}))}},{"../compose":27}],30:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.distinct=r.nonNullable=r.to=r.throttleTime=void 0;var n=t("./throttleTime");Object.defineProperty(r,"throttleTime",{enumerable:!0,get:function(){return n.throttleTime}});var o=t("./to");Object.defineProperty(r,"to",{enumerable:!0,get:function(){return o.to}});var i=t("./nonNullable");Object.defineProperty(r,"nonNullable",{enumerable:!0,get:function(){return i.nonNullable}});var a=t("./distinct");Object.defineProperty(r,"distinct",{enumerable:!0,get:function(){return a.distinct}})},{"./distinct":29,"./nonNullable":31,"./throttleTime":32,"./to":33}],31:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.nonNullable=void 0;var n=function(t){return null==t?null:[t]};r.nonNullable=function(){return n}},{}],32:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.throttleTime=void 0;var n=t("../compose");r.throttleTime=function(t){return n.compose([function(e,r){var n=r.lastClick,o=Date.now();return o-n<t?null:[{data:e,lastClick:o}]},{lastClick:0,data:null}],(function(t){return[t.data]}))}},{"../compose":27}],33:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.to=void 0;var n=new Map;r.to=function(t){var e;return null!==(e=n.get(t))&&void 0!==e?e:(n.set(t,(function(e){return e[0]!==t?null:[e[1]]})),r.to(t))}},{}],34:[function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.compose=void 0,o(t("./genericOperators"),r);var i=t("./compose");Object.defineProperty(r,"compose",{enumerable:!0,get:function(){return i.compose}})},{"./compose":27,"./genericOperators":30}],35:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.VoidDeferred=r.Deferred=void 0;var i=t("tsafe/lab/overwriteReadonlyProp"),a=function(){var t,e,r=this;this.isPending=!0,this.pr=new Promise((function(n,o){t=function(t){i.overwriteReadonlyProp(r,"isPending",!1),n(t)},e=function(t){i.overwriteReadonlyProp(r,"isPending",!1),o(t)}})),this.resolve=t,this.reject=e};r.Deferred=a;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(a);r.VoidDeferred=u},{"tsafe/lab/overwriteReadonlyProp":47}],36:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.safeClearTimeout=r.safeSetTimeout=void 0;r.safeSetTimeout=function(t,e){return setTimeout(t,e)};r.safeClearTimeout=function(t){return clearTimeout(t)}},{}],37:[function(t,e,r){"use strict";r.__esModule=!0,Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<r;){var i=e[o];if(t.call(n,i,o,e))return i;o++}},configurable:!0,writable:!0})},{}],38:[function(t,e,r){"use strict";r.__esModule=!0,r.Polyfill=r.LightMapImpl=void 0;var n=function(){function t(){this.record=[]}return t.prototype.has=function(t){return this.record.map((function(t){return t[0]})).indexOf(t)>=0},t.prototype.get=function(t){var e=this.record.filter((function(e){return e[0]===t}))[0];if(void 0!==e)return e[1]},t.prototype.set=function(t,e){var r=this.record.filter((function(e){return e[0]===t}))[0];return void 0===r?this.record.push([t,e]):r[1]=e,this},t.prototype.delete=function(t){var e=this.record.map((function(t){return t[0]})).indexOf(t);return!(e<0)&&(this.record.splice(e,1),!0)},t.prototype.keys=function(){return this.record.map((function(t){return t[0]}))},t}();r.LightMapImpl=n,r.Polyfill="undefined"!=typeof Map?Map:n},{}],39:[function(t,e,r){"use strict";r.__esModule=!0,Object.is||(Object.is=function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e})},{}],40:[function(t,e,r){"use strict";r.__esModule=!0,r.Polyfill=r.LightSetImpl=void 0;var n=t("./Map"),o=function(){function t(t){if(this.map=new n.Polyfill,void 0!==t)for(var e=0,r=t;e<r.length;e++){var o=r[e];this.add(o)}}return t.prototype.has=function(t){return this.map.has(t)},t.prototype.add=function(t){return this.map.set(t,!0),this},t.prototype.values=function(){return this.map.keys()},t.prototype.delete=function(t){return this.map.delete(t)},t}();r.LightSetImpl=o,r.Polyfill="undefined"!=typeof Set?Set:o},{"./Map":38}],41:[function(t,e,r){"use strict";r.__esModule=!0,r.Polyfill=void 0;var n=t("./Map");r.Polyfill="undefined"!=typeof WeakMap?WeakMap:n.Polyfill},{"./Map":38}],42:[function(t,e,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n};r.__esModule=!0,r.buildMethodCb=r.buildCb=r.getPrComplete=r.isRunning=r.cancelAllQueuedCalls=r.getQueuedCallCount=r.buildMethod=r.build=r.createGroupRef=void 0;var o=t("minimal-polyfills/WeakMap"),i=function(){function t(){this.queuedCalls=[],this.isRunning=!1,this.prComplete=Promise.resolve()}return t.prototype.cancelAllQueuedCalls=function(){var t;return this.queuedCalls.splice(0,t=this.queuedCalls.length),t},t}(),a={},u=new o.Polyfill;function s(t,e){var r=u.get(t);r||(r=new o.Polyfill,u.set(t,r));var n=r.get(e);return n||(n=new i,r.set(e,n)),n}function c(){return new Array(0)}r.createGroupRef=c,r.build=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];switch(t.length){case 1:return p(!0,c(),t[0]);case 2:return p(!0,t[0],t[1])}},r.buildMethod=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];switch(t.length){case 1:return p(!1,c(),t[0]);case 2:return p(!1,t[0],t[1])}},r.getQueuedCallCount=function(t,e){var r=f(t,e);return r?r.queuedCalls.length:0},r.cancelAllQueuedCalls=function(t,e){var r=f(t,e);return r?r.cancelAllQueuedCalls():0},r.isRunning=function(t,e){var r=f(t,e);return!!r&&r.isRunning},r.getPrComplete=function(t,e){var r=f(t,e);return r?r.prComplete:Promise.resolve()};var l=new o.Polyfill;function f(t,e){void 0===e&&(e=a);var r=l.get(t);if(!r)throw Error("Not a run exclusiveFunction");var n=u.get(e);if(n)return n.get(r)}function p(t,e,r){var n,o=function(){for(var o=this,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(!t){if(!(this instanceof Object))throw new Error("Run exclusive, <this> should be an object");n=s(this,e)}return new Promise((function(t,e){var a;n.prComplete=new Promise((function(t){return a=function(){return t()}}));var u=function(r){a(),n.isRunning=!1,n.queuedCalls.length&&n.queuedCalls.shift()(),"data"in r?t(r.data):e(r.reason)};(function t(){for(var e=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(n.isRunning)n.queuedCalls.push((function(){return t.apply(e,o)}));else{n.isRunning=!0;try{r.apply(this,o).then((function(t){return u({data:t})})).catch((function(t){return u({reason:t})}))}catch(t){u({reason:t})}}}).apply(o,i)}))};return t&&(n=s(a,e)),l.set(o,e),o}function d(t,e,r){var o,i=function(){for(var i=this,a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];if(!t){if(!(this instanceof Object))throw new Error("Run exclusive, <this> should be an object");o=s(this,e)}var c,l=void 0;a.length&&"function"==typeof a[a.length-1]&&(l=a.pop()),o.prComplete=new Promise((function(t){return c=function(){return t()}}));var f=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c(),o.isRunning=!1,o.queuedCalls.length&&o.queuedCalls.shift()(),l&&l.apply(i,t)};f.hasCallback=!!l,function t(){for(var e=this,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(o.isRunning)o.queuedCalls.push((function(){return t.apply(e,i)}));else{o.isRunning=!0;try{r.apply(this,n(i,[f]))}catch(t){throw t.message+=" ( This exception should not have been thrown, miss use of run-exclusive buildCb )",t}}}.apply(this,a)};return t&&(o=s(a,e)),l.set(i,e),i}r.buildCb=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];switch(t.length){case 1:return d(!0,c(),t[0]);case 2:return d(!0,t[0],t[1])}},r.buildMethodCb=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];switch(t.length){case 1:return d(!1,c(),t[0]);case 2:return d(!1,t[0],t[1])}}},{"minimal-polyfills/WeakMap":41}],43:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.assert=r.AssertionError=void 0;var a=t("./lab/overwriteReadonlyProp"),u=t("./zz_internal/assertIsRefWrapper"),s=function(t){function e(e){var r=this.constructor,n=t.call(this,"Wrong assertion encountered"+(e?': "'+e+'"':""))||this;if(Object.setPrototypeOf(n,r.prototype),!n.stack)return n;try{a.overwriteReadonlyProp(n,"stack",n.stack.split("\n").filter((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=i(t,2),n=r[1];return 1!==n&&2!==n})).join("\n"))}catch(t){}return n}return o(e,t),e}(Error);r.AssertionError=s,r.assert=function(t,e){if(void 0===u.assertIsRefWrapper.ref){if(!t)throw new s(e)}else u.assertIsRefWrapper.ref=void 0}},{"./lab/overwriteReadonlyProp":47,"./zz_internal/assertIsRefWrapper":49}],44:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.id=void 0;r.id=function(t){return t}},{}],45:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.is=void 0;var n=t("./zz_internal/assertIsRefWrapper"),o=["Wrong usage of the "+i.name+" function refer to","https://docs.tsafe.dev/"+i.name.toLowerCase()].join(" ");function i(t){var e={};if(void 0!==n.assertIsRefWrapper.ref)throw n.assertIsRefWrapper.ref=void 0,new Error(o);return n.assertIsRefWrapper.ref=e,Promise.resolve().then((function(){if(n.assertIsRefWrapper.ref===e)throw new Error(o)})),null}r.is=i},{"./zz_internal/assertIsRefWrapper":49}],46:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isPromiseLike=void 0,r.isPromiseLike=function(t){return"function"==typeof(null==t?void 0:t.then)}},{}],47:[function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.overwriteReadonlyProp=void 0;r.overwriteReadonlyProp=function(t,e,r){try{t[e]=r}catch(t){}if(t[e]===r)return r;var o=void 0,i=Object.getOwnPropertyDescriptor(t,e)||{enumerable:!0,configurable:!0};if(i.get)throw new Error("Probably a wrong ides to overwrite "+e+" getter");try{Object.defineProperty(t,e,n(n({},i),{value:r}))}catch(t){o=t}if(t[e]!==r)throw o||new Error("Can't assign");return r}},{}],48:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.typeGuard=void 0,r.typeGuard=function(t,e){return e}},{}],49:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.assertIsRefWrapper=void 0;var n=t("../id");r.assertIsRefWrapper={ref:n.id(void 0)}},{"../id":44}]},{},[18])(18)}));